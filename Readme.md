**Product Chat Assistant**
==========================

**Overview**
------------

This is a Streamlit app that provides a chat interface for users to ask questions about various products. The app uses a fine-tuned LLaMA 2 model to generate responses to user queries, and can even bargain with the user to some extent.

**Features**
------------

* Select a product from a list of available products
* Ask questions about the selected product
* View chat history with the assistant
* Get responses to user queries generated by the fine-tuned LLaMA 2 model
* Engage in bargaining with the assistant to negotiate prices or other terms

**Fine-tuning Details**
---------------------

The LLaMA 2 model was fine-tuned using UnSloth, a powerful tool for fine-tuning large language models. The fine-tuning process involved training the model on a custom dataset created using Gemini and OpenAI.

**Dataset**
----------

The custom dataset used for fine-tuning the model consists of 500 examples of product-related conversations, including [product descriptions, customer reviews, customer converation]. The dataset was created using Gemini and OpenAI, and is designed to simulate real-world conversations about products.The app uses a CSV file `cleaned_data.csv` as the dataset, which contains product information.

**How to Use**
--------------

1. Run the app by executing `streamlit run app.py` in your terminal/command prompt.
2. Select a product from the dropdown list in the sidebar.
3. Ask a question about the selected product in the chat input field.
4. View the response from the assistant in the chat window.
5. Continue chatting with the assistant to get more information about the product.

**Code Snippets**
--------------

### Initialize Model and Tokenizer
```
global_tokenizer, global_model = loading_model_and_tokenizer('models/model', 'models/adapter')
```

### Reset Session State
```
def reset_session(selected_product):
    st.session_state.messages = [{
        'role': 'assistant',
        'content': f'Hello! How may I help you with Product {selected_product}?'
    }]
    st.session_state.product_details = {'product_info': selected_product}
```

### Generate and Process Assistant Response
```
input_text = input_prompt(product_details, prompt)
response = get_response_from_model(global_tokenizer, global_model, input_text)
filtered_response = filtering_response(response) 
final_response = filter_final_response(filtered_response)
```

**Technical Details**
--------------------

* The app uses a pre-trained model to generate responses to user queries.
* The model is loaded using the `loading_model_and_tokenizer` function.
* The app uses Streamlit's session state to store chat history and product details.
* The `main` function is the entry point of the app, and it handles the chat interface and response generation.

**Dependencies**
---------------

The app requires the following dependencies to run:

```
huggingface_hub
ipython
langchain
transformers
accelerate
pandas
numpy
datasets
streamlit
bitsandbytes
"unsloth @unsloth[cu121] git+https://github.com/unslothai/unsloth.git"
```

**How to Run**
--------------

To run the app, execute the following command in your terminal/command prompt:
```
streamlit run app.py
```

**Helper Functions**
-------------------

The app uses several helper functions defined in the `helper` module, including:

* `product_name_list`: Returns a list of product names from the dataset.
* `get_product_details`: Returns product details for a given product.
* `input_prompt`: Generates an input prompt for the model based on user input and product details.
* `get_response_from_model`: Generates a response from the model based on the input prompt.
* `filtering_response`: Filters the response from the model.
* `filter_final_response`: Filters the final response to be displayed to the user.
* `initialize_model`: Initializes the pre-trained model.
* `loading_model_and_tokenizer`: Loads the pre-trained model and tokenizer.

**License**
---------

This app is licensed under the MIT License. See `LICENSE` for details.

**Contact**
---------

For any questions or issues, please contact Mandalor_09.

**Demo Video**
-------------

Check out this demo video to see the app in action:

[![Demo Video](https://github.com/Mandalor-09/Bg_Bot/blob/main/thumbnail.png)](https://github.com/Mandalor-09/Bg_Bot/blob/main/bg_video_2.mp4)

In this video, you'll see a demonstration of the app's features, including:

* Selecting a product and asking questions about it
* Engaging in a conversation with the assistant
* Bargaining with the assistant to negotiate prices or other terms